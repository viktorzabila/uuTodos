function makeResponse(responseInfo, error) {
  const response = responseInfo ? responseInfo.response : null;
  const res = {
    status: response ? response.status : 0,
    headers: function (aHeader) {
      if (!aHeader) {
        if (!response) return "";
        let result = [];
        for (let [k, v] of response.headers) result.push(k + ": " + v);
        return result.join("\r\n");
      }
      return response ? response.headers.get(aHeader) : null;
    },
    data: responseInfo && responseInfo.body != null ? responseInfo.body : responseInfo,
  };

  if (responseInfo) {
    if (responseInfo.filename !== undefined) {
      res.filename = responseInfo.filename;
      if (res.data) res.data.filename = res.filename;
    }
    if (responseInfo.contentType !== undefined) {
      res.contentType = responseInfo.contentType;
      if (res.data) res.data.contentType = res.contentType;
    }
    if (responseInfo.encoding !== undefined) {
      res.encoding = responseInfo.encoding;
      if (res.data) res.data.encoding = res.encoding;
    }
  }

  return error ? { ...res, ...error } : res;
}

module.exports = makeResponse;
