"use strict";

const Logger = require("../monitoring/access-log.js");
const Morgan = require("morgan");

const MIDDLEWARE_ORDER = -600;

const stream = {
  write: function(message, encoding) {
    // Message is logged via "formatter"
    // represented by access log itself.
  }
};

/**
 * AccessLog uses Morgan, an Express recommended request logger.
 */
class AccessLog {
  constructor() {
    this.order = MIDDLEWARE_ORDER;
  }

  /**
   * Getter that returns Express compliant middleware function.
   * @returns {Function}
   */
  get pre() {
    return Morgan(Logger.log, { stream });
  }
}

/**
 * Module exports AccessLog constructor.
 * @type {AccessLog}
 */
module.exports = AccessLog;
