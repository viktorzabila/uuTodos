"use strict";

const UseCaseError = require("./use-case-error.js");

class InvalidCredentials extends UseCaseError {
  constructor(msg, cause = null) {
    super(msg, cause);
    this.status = 401;
    this.code = `${UseCaseError.ERROR_PREFIX}authentication/invalidCredentials`;
  }

  requireAuthentication(type, realm) {
    let value = type.toString().toLowerCase();
    value = value[0].toUpperCase() + value.substr(1);
    if (realm) value += ` realm="${realm}"`;
    this.headers["WWW-Authenticate"] = value;
  }
}

module.exports = InvalidCredentials;
