"use strict";

const UseCaseError = require("./use-case-error.js");

class AccessDenied extends UseCaseError {
  constructor(authorizationResult, message, cause = null) {
    if (typeof authorizationResult === "string") {
      cause = message;
      message = authorizationResult;
      authorizationResult = null;
    }
    super(message, cause);
    this.status = 403;
    this.code = `${UseCaseError.ERROR_PREFIX}authorization/accessDenied`;
    if (authorizationResult && !this.dtoOut) {
      this.dtoOut = {
        uuIdentity: authorizationResult.getUuIdentity(),
        authorizedProfileList: authorizationResult.getAuthorizedProfiles(),
        identityProfileList: authorizationResult.getIdentityProfiles()
      };
    }
  }
}

module.exports = AccessDenied;
