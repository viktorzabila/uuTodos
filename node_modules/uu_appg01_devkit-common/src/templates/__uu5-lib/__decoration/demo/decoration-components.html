<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Decoration Components Demo</title>

    <script>
      // prettier-ignore
      if (!location.href.match(/^(about:|file:)/)) {
        var bplCookie = document.cookie.match(/(^|;\s*)uu\.app\.bpl=([^;]+)/);
        var bplSegmentCount = (bplCookie ? Number(bplCookie[2]) : null);
        if (typeof bplSegmentCount !== "number" || isNaN(bplSegmentCount) || bplSegmentCount < 0) bplSegmentCount = 2;
        var appBaseUrlPath = (location.pathname.split(/\//).slice(0,1+bplSegmentCount).join("/")+"/").replace(/\/+/g,"/").replace(/"/g,"");
        var appAssetsRelativeUrlPath = "public/1.0.0/";
        document.write('<base href="' + appBaseUrlPath + appAssetsRelativeUrlPath + '" data-uu-app-base="' + appBaseUrlPath + '" data-uu-app-assets-base="' + appAssetsRelativeUrlPath + '">');
      }
    </script>

    <script src="https://cdn.plus4u.net/uu-uu5loaderg01/1.0.0/uu5loaderg01.min.js" crossorigin="anonymous"></script>
    <script>
      // prettier-ignore
      Uu5Loader.config({
        "imports": {
          "react": "https://cdn.plus4u.net/libs/react/16.14.0/react.min.js",
          "react-dom": "https://cdn.plus4u.net/libs/react-dom/16.14.0/react-dom.min.js",
          "prop-types": "https://cdn.plus4u.net/libs/prop-types/15.7.2/prop-types.min.js",

          "uu5g05": "https://cdn.plus4u.net/uu-uu5g05/0.0.0/uu5g05.min.js",
          "uu5g05-elements": "https://cdn.plus4u.net/uu-uu5g05/0.0.0/uu5g05-elements.min.js",
          "uu5stringg01": "https://cdn.plus4u.net/uu-uu5stringg01/1.0.0/uu5stringg01.min.js",
          "uu_plus4u5decorationg01": "https://cdn.plus4u.net/uu-plus4u5decorationg01/0.0.0/uu_plus4u5decorationg01.min.js",

          "<%= context.name %>": "https://cdn.plus4u.net/<%= context.vendor%>-<%= context.nameNoVendor.replace(/-.*/, '').replace(/_/g, '-')%>/<%= context.appVersion.replace(/\..*/, '.0.0') %>/<%= context.name %>.min.js",
        }
      });
    </script>
  </head>
  <body>
    <div id="renderHere"></div>

    <script src="https://cdn.plus4u.net/uu-app-templateg01/1.0.0/in-browser-transpilation.js" crossorigin="anonymous"></script>
    <script type="text/babel">
      import { Utils, createComponent, useState } from "uu5g05";
      import Uu5Elements from "uu5g05-elements";
      import <%= context.namespace.replace(/\./g, "") %> from "<%= context.name %>";

      const Config = {
        Css: Utils.Css.createCssModule("uu-demo"),
      };
      const sizingPaletteBox = Uu5Elements.UuGds.getValue(["SizingPalette"]).box;
      const ASPECT_RATIOS = Object.keys(sizingPaletteBox).filter((it) => it !== "1x10" && it !== "10x1");
      const SIZES = Object.keys(sizingPaletteBox[ASPECT_RATIOS[0]]);

      const componentNames = Object.keys(<%= context.namespace.replace(/\./g, "") %> || {}).filter((it) => it[0].match(/[A-Z]/));

      const ImageShowcase = createComponent({
        render(props) {
          const { component: Component } = props;
          const [aspectRatio, setAspectRatio] = useState("all");
          const [size, setSize] = useState("all");

          let propsList = [];
          for (let size of size === "all" ? SIZES : [size]) {
            for (let aspectRatio of aspectRatio === "all" ? ASPECT_RATIOS : [aspectRatio]) {
              propsList.push({ size, aspectRatio });
            }
          }

          return (
            <div>
              <div>
                <Uu5Elements.Dropdown
                  itemList={SIZES.concat(["all"]).map((item) => ({
                    children: item,
                    significance: item === size ? "highlighted" : undefined,
                    onClick: () => setSize(item),
                  }))}
                  label={"Size: " + size}
                  significance="subdued"
                  className={Config.Css.css`margin-right: 8px;`}
                />
                <Uu5Elements.Dropdown
                  itemList={ASPECT_RATIOS.concat(["all"]).map((item) => ({
                    children: item,
                    significance: item === aspectRatio ? "highlighted" : undefined,
                    onClick: () => setAspectRatio(item),
                  }))}
                  label={"Aspect ratio: " + aspectRatio}
                  significance="subdued"
                  className={Config.Css.css`margin-right: 8px;`}
                />
              </div>
              {propsList.map((props, i) => (
                <div key={i} className={Config.Css.css`display: inline-block; vertical-align: top; margin: 8px;`}>
                  <div className={Config.Css.css`text-align: center;`}>
                    {props.size}, {props.aspectRatio}
                  </div>
                  <Component {...props} />
                </div>
              ))}
            </div>
          );
        },
      });

      const Page = createComponent({
        render() {
          let [activeName, setActiveName] = useState(componentNames[0]);
          let Component = activeName ? <%= context.namespace.replace(/\./g, "") %>[activeName] : null;
          return (
            <div className={Config.Css.css`padding: 32px;`}>
              <div className={Config.Css.css`margin-bottom: 8px;`}>
                {componentNames.map((name) => (
                  <Uu5Elements.Button
                    key={name}
                    className={Config.Css.css`margin-right: 8px;`}
                    significance={name === activeName ? "highlighted" : "subdued"}
                    colorScheme="primary"
                    children={<%= context.namespace.replace(/\./g, "") %>[name].uu5Tag}
                    onClick={() => setActiveName(name)}
                  />
                ))}
              </div>
              {!Component ? (
                "There are no components in the library yet."
              ) : Component.sourceUu5Tag === "Plus4U5Decoration.Image" ? (
                <ImageShowcase component={Component} />
              ) : (
                <Component />
              )}
            </div>
          );
        },
      });

      Utils.DOM.render(<Page />, document.getElementById("renderHere"));
    </script>
  </body>
</html>
