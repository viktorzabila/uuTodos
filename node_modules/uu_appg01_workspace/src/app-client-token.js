"use strict";

const JsonWebToken = require("jsonwebtoken");

class AppClientToken {
  constructor(token) {
    this._original = token;
    this._parsed = JsonWebToken.decode(token, { complete: true });
  }

  getIssuer() {
    return this._parsed.payload.iss;
  }

  getSubject() {
    return this._parsed.payload.sub;
  }

  getAudience() {
    return this._parsed.payload.aud;
  }

  getJwtId() {
    return this._parsed.payload.jti;
  }

  getIssueTime() {
    return this._parsed.payload.iat;
  }

  getExpirationTime() {
    return this._parsed.payload.exp;
  }

  _getTokenOrigin() {
    return this._original;
  }

  _getJwt() {
    return this._parsed;
  }
}

module.exports = AppClientToken;
