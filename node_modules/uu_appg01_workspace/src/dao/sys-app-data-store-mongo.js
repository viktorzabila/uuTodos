"use strict";

const { DbConnection } = require("uu_appg01_datastore");
const { UuObjectDao } = require("uu_appg01_objectstore");

class SysAppDataStoreMongo extends UuObjectDao {
  static async getListOfCollections(connectionString) {
    let db = await DbConnection.get(connectionString);
    return await db.listCollections().toArray();
  }

  static async dropCollection(connectionString, collectionName) {
    let db = await DbConnection.get(connectionString);
    return db.collection(collectionName).drop();
  }
}

module.exports = SysAppDataStoreMongo;
